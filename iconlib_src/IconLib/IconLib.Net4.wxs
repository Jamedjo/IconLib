<?xml version="1.0" encoding="utf-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: 
    lightArgs: "<projectname>.wixobj" -out "<projectname>.msi" -ext WixUIExtension -ext WixNetFxExtension
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
    <Product Id="B75F341F-9466-4C20-A91E-819BBD520ABE" Name="IconLib" Language="1033" Version="0.75.0.0" Manufacturer="Harborsiem" UpgradeCode="2374BC1D-998C-4BE5-A057-C5645E73F87D">
        <Package Description="Icon Library for .NET Framework 4" InstallerVersion="301" Compressed="yes" Manufacturer="Harborsiem" Keywords="Microsoft Windows Installer, MSI" Platform="x86" InstallScope="perMachine" />
        <Media Id="1" Cabinet="Data.cab" EmbedCab="yes" />
        <MajorUpgrade DowngradeErrorMessage="A later version of [ProductName] is already installed." Schedule="afterInstallValidate" />
        <Directory Id="TARGETDIR" Name="SourceDir">
            <Directory Id="ProgramFilesFolder" Name="ProgramFiles">
                <Directory Id="Di.IconLib" Name="IconLib">
                    <Directory Id="Di.Bin4" Name="bin4">
                    </Directory>
                </Directory>
            </Directory>
        </Directory>
        <DirectoryRef Id="TARGETDIR">
            <Component Id="C.RegistryEntries" Guid="CDBA3CF3-4C03-4E2D-9E2B-65A9D6150B0F">
                <!--
                .NET2.0, 3.5 GAC Assembly
                <RegistryKey Root="HKLM" Key="Software\Microsoft\.NETFramework\AssemblyFolders\[ProductName]" ForceCreateOnInstall="yes" ForceDeleteOnUninstall="yes" Id="R.AssemblyRef">
                    <RegistryValue Type="string" Value="[ProgramFilesFolder]IconLib\bin4\" KeyPath="yes" />
                </RegistryKey>
                -->
                <!--
                .NET4.x GAC Assembly
                -->
                <RegistryKey Root="HKLM" Key="Software\Microsoft\.NETFramework\v4.0.30319\AssemblyFoldersEx\[ProductName]" ForceCreateOnInstall="yes" ForceDeleteOnUninstall="yes" Id="R.AssemblyRef">
                    <RegistryValue Type="string" Value="[ProgramFilesFolder]IconLib\bin4\" KeyPath="yes" />
                </RegistryKey>
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="TARGETDIR">
            <Component Id="C.GacDll" Guid="01F51411-F30B-4BE4-AA31-A2C6FF99C3EB">
                <File Id="Fi.GacDll" Name="IconLib.dll" Source="bin4\Release\IconLib.dll" KeyPath="yes" Assembly=".net" />
            </Component>
        </DirectoryRef>
        <DirectoryRef Id="Di.Bin4">
            <Component Id="C.Bin4" Guid="B803C1EE-53A5-44A5-8C67-2DA469D97479">
                <File Id="Fi.DllClone" Name="IconLib.dll" Source="bin4\Release\IconLib.dll" KeyPath="yes" />
            </Component>
        </DirectoryRef>
        <UI />
        <PropertyRef Id="NETFRAMEWORK40FULL" />
        <Condition Message="This library requires .NET Framework 4.0.">Installed OR NETFRAMEWORK40FULL</Condition>
        <Feature Id="DefaultFeature" Level="1">
            <ComponentRef Id="C.Bin4" />
            <ComponentRef Id="C.GacDll" Primary="yes" />
            <ComponentRef Id="C.RegistryEntries" />
        </Feature>
        <UIRef Id="WixUI_Minimal" />
        <UIRef Id="WixUI_ErrorProgressText" />
        <WixVariable Id="WixUILicenseRtf" Value="MIT_License.rtf" />
    </Product>
</Wix>